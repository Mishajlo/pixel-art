import{u as O}from"./pixels-Bozm9vif.js";import{d as Q,y as X,i as M,r as m,z as Y,A as I,B as A,C as Z,o as n,c as u,a as k,t as f,e as g,F as w,h as K,n as z,u as y,b as P,q as $,D as L,E as j,_ as ee}from"./index-DYgGcjCx.js";const ie={key:0,id:"pag"},te={key:1,id:"galerija"},oe=["onClick"],ae={id:"info",style:{display:"flex","flex-direction":"column"}},ne={key:1,id:"zamraci"},se={id:"potvrda"},re=["onClick"],le={key:2,id:"ceca"},ue=Q({__name:"GalleryComponent",props:{korisnikId:{type:String,default:""}},emits:["NovKorisnikId"],async setup(R,{emit:T}){let B,N;[B,N]=X(()=>new Promise(s=>setTimeout(s))),await B,N();const D=T,v=R;function G(s){D("NovKorisnikId",s)}const b=M("Korisnik"),_=O(),x=m(!1);m("");const F=_.getPixels,V=m(_.getBroj),a=m([]),h=m(!0),E=M("Token"),c=m(1),C=m(1);_.matrixGrid(F,V.value),Y(()=>{S()});async function U(s){_.deleteImage(s,String(E.value)),H(s)}function q(){c.value>=C.value||c.value++}function W(){c.value!=1&&c.value--}function H(s){for(let r=0;r<a.value.length;r++)a.value[r].idSlike===s&&a.value.splice(r,1);a.value.length===0&&(h.value=!1)}I(a.value,()=>{S()}),I(()=>c.value,s=>{const r=new AbortController;setTimeout(async()=>{try{console.log(v.korisnikId);const d=new URLSearchParams({limit:String(10),page:String(s),older_first:"false",author:""});v.korisnikId&&d.set("author",v.korisnikId);const e=await A.get(`https://raf-pixeldraw.aarsen.me/api/pictures/?${d}`,{signal:r.signal});a.value=[];const i=e.data.pictures;C.value=Math.ceil(e.data.total/10),console.log(c.value),i.length===0&&(h.value=!1);for(let t=0;t<i.length;t++){const l=i[t].picture_data;a.value[t]={korisnik:i[t].author.username,naziv:i[t].name,idKorisnika:i[t].author.user_id,idSlike:i[t].picture_id,pikseli:[]};for(let o=0;o<l.length;o++){a.value[t].pikseli[o]=[];for(let p=0;p<l.length;p++)a.value[t].pikseli[o][p]={idi:o,idj:p,boja:l[p][o],border:1}}}}catch{console.log("SlowDown!")}}),j(()=>{r.abort()})});function J(){return v.korisnikId}I(J,()=>{c.value=1});async function S(){const s=new AbortController;console.log(v.korisnikId);const r=new URLSearchParams({limit:String(10),page:String(c.value),older_first:"false",author:""});v.korisnikId&&r.set("author",v.korisnikId);const d=await A.get(`https://raf-pixeldraw.aarsen.me/api/pictures/?${r}`,{signal:s.signal});a.value=[];const e=d.data.pictures;C.value=Math.ceil(d.data.total/10),console.log(c.value),e.length===0&&(h.value=!1);for(let i=0;i<e.length;i++){const t=e[i].picture_data;a.value[i]={korisnik:e[i].author.username,naziv:e[i].name,idKorisnika:e[i].author.user_id,idSlike:e[i].picture_id,pikseli:[]};for(let l=0;l<t.length;l++){a.value[i].pikseli[l]=[];for(let o=0;o<t.length;o++)a.value[i].pikseli[l][o]={idi:l,idj:o,boja:t[o][l],border:1}}}}return(s,r)=>{const d=Z("RouterLink");return n(),u(w,null,[h.value?(n(),u("div",ie,[k("button",{class:"dugme",onClick:W},f("<")),k("label",null,f(c.value)+" / "+f(C.value),1),k("button",{class:"dugme",onClick:q},f(">"))])):g("",!0),h.value?(n(),u("div",te,[(n(!0),u(w,null,K(a.value,(e,i)=>(n(),u("div",{id:"griid",key:i},[k("div",{onClick:t=>y(_).primiSliku(e),id:"gred",style:z({"--size":e.pikseli.length})},[(n(!0),u(w,null,K(e.pikseli,(t,l)=>(n(),u("div",{id:"reed",key:l,style:z({"--size":e.pikseli.length})},[(n(!0),u(w,null,K(t,(o,p)=>(n(),u("div",{key:p,style:z({backgroundColor:o.boja,borderRadius:o.border})},null,4))),128))],4))),128))],12,oe),k("div",ae,[e.idKorisnika===y(b)&&!x.value?(n(),u("button",{key:0,id:"dugme",onClick:r[0]||(r[0]=t=>x.value=!0)},"Delete")):g("",!0),e.idKorisnika===y(b)&&x.value?(n(),u("div",ne,[k("div",se,[k("button",{id:"dugme",onClick:t=>U(e.idSlike)},"Confirm",8,re)])])):g("",!0),e.idKorisnika!==y(b)?(n(),P(d,{key:2,id:"info",to:"/gallery",onMousedown:t=>G(e.idKorisnika),onMouseup:S},{default:$(()=>[L("Author: "+f(e.korisnik),1)]),_:2},1032,["onMousedown"])):g("",!0),e.idKorisnika===y(b)?(n(),P(d,{key:3,id:"info",to:"/myGallery",onMouseup:S,style:{"margin-bottom":"-7px"}},{default:$(()=>[L("Author: "+f(e.korisnik),1)]),_:2},1024)):g("",!0),k("label",null,"Name: "+f(e.naziv),1)])]))),128))])):g("",!0),h.value?g("",!0):(n(),u("p",le,"For Ceca There Isn't"))],64)}}}),ke=ee(ue,[["__scopeId","data-v-dfd4632e"]]);export{ke as default};
